from attrs import define, field
import RPi.GPIO as GPIO

@define(auto_attribs=True)
class ServoModule:
    gpin = field(alias='RaspBerri GPIN', default=11)
    position = field(alias='servo position', default=0)

    def __attrs_post_init__(self):
        GPIO.setmode(GPIO.BOARD)
        GPIO.setup(self.gpin, GPIO.OUT)
        self.servo = GPIO.PWM(self.gpin, 50)
        self.default_move()

    def _calculate_duty_cycle_percentage(self, angle: int):
        return (angle / 18) + 3

    def default_move(self):
        self.servo.ChangeDutyCycle(
            self._calculate_duty_cycle_percentage(self.position)
        )

    def move_to(self, position):
        self.servo.ChangeDutyCycle(
            self._calculate_duty_cycle_percentage(position)
        )
